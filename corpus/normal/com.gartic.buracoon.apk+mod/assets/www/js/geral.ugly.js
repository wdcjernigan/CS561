function Loader(a){var b,c=this;b=window.devicePixelRatio>=1.5?["bg@2x.jpg","baralho@2x.png","logo_"+idioma.cod+"@2x.png","logoEfeito_"+idioma.cod+"@2x.png","logoFundo@2x.png","spriteTela.png","spriteChat.png"]:["bg.jpg","baralho.png","logo_"+idioma.cod+".png","logoEfeito_"+idioma.cod+".png","logoFundo.png","spriteTela.png","spriteChat.png"];var d,e=["cadastro","jogar","lobby","login","perfil","ranking","senha","sobre"],f=["comprarCarta","descerJogo","descerLixo","jogadorVez"],g=[],h=[],i=0,j=function(){var c=b.length+e.length;i++,i==c&&a()};for(var k in f)g[f[k]]=new Media("/android_asset/www/audio/"+f[k]+".mp3",function(){},function(){});for(var k in b)d=new Image,d.onload=j,d.onerror=j,d.src="imgs/"+b[k];for(var k in e)ajax.chamada("pags/"+idioma.cod+"/"+e[k]+".html","nada=nada",function(a,b){h[b]=a,j()},e[k]);c.getSons=function(){return g},c.getPage=function(a){return h[a]}}function Ajax(){function novoObjeto(){try{xmlhttp=new XMLHttpRequest}catch(a){try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){xmlhttp=!1}}}}function rotina(){if(null!=atual){var a=UTCTime()-inicialTime;a>2e3&&(console.log("abortou"),self.abortar())}}function objRequest(a,b,c,d,e){this.pag=a,this.tipo=b,this.param=c,this.func=d,this.method=e}function UTCTime(){var a=new Date;return Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function ajaxRequest(){if(null!=atual){inicialTime=UTCTime(),xmlhttp.open(atual.method,atual.pag,!0);try{xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(e){}xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState){var status=0;try{status=xmlhttp.status}catch(e){return novoObjeto(),void 0}if(null!=atual.func){var texto=xmlhttp.responseText;atual.func instanceof Function?atual.func(texto,atual.tipo):eval(atual.func+"(texto)")}lastTime=UTCTime(),fila.length>0?(atual=fila.shift(),delay()):atual=null}};try{"GET"==atual.method?xmlhttp.send(null):xmlhttp.send(atual.param)}catch(e){}}}function delay(){var a=UTCTime()-lastTime;a>700?ajaxRequest():(a=700-a,setTimeout(function(){ajaxRequest()},a))}function msg(a){if(rodarMsg){var b=document.createElement("div");b.innerHTML=a,100>linhasMsg?linhasMsg++:$("#ajaxTxt")[0].removeChild($("ajaxTxt").firstChild),$("#ajaxTxt")[0].appendChild(b),$("#ajaxTxt")[0].scrollTop=$("ajaxTxt").scrollHeight}}var self=this,atual=null,fila=new Array,lastTime=0,xmlhttp,lastUpdate=UTCTime();novoObjeto(),setInterval(function(){rotina()},100),self.chamada=function(a,b,c,d){lastUpdate=UTCTime();var e=new objRequest(a,d,b,c,"POST");null==atual?(atual=e,delay()):fila.push(e)},self.abortar=function(){xmlhttp.abort(),ajaxRequest()}}function Sons(a){function b(){console.log("playAudio():Audio Success")}function c(a){console.log("Erro ao tocar som ("+a.code+") - "+a.message)}var d=this,e="/android_asset/www/audio/",f=!0,g="mp3";a||(a=[]),d.load=function(d){for(key in d){var f=d[key];a[f]||(a[f]=new Media(e+f+"."+g,b,c))}},d.play=function(b){f&&a[b]&&a[b].play()},d.ativar=function(){f=!0},d.desativar=function(){f=!1},d.getAtivo=function(){return f}}function Conexao(a){function b(){socket=io.connect(a+"/buraco",{"connect timeout":1e4,reconnect:!0,"auto connect":!0,"reconnection delay":500,"reconnection limit":5e3,"max reconnection attempts":1/0,"try multiple transports":!1,transports:["websocket"]})}function c(){E||(H&&clearTimeout(H),G&&clearTimeout(G),F&&clearInterval(F),console.log("CONECTOU"),E=!0,I=!0,J=0,window.localStorage&&window.localStorage.getItem("idSocket")?d=window.localStorage.getItem("idSocket"):(d=socket.socket.sessionid,window.localStorage.setItem("idSocket",d)),buraco.fecharMensagem(),e.envioMsg(g,{id:d,nick:window.localStorage.getItem("nick"),local:D,idioma:idiomaID,versao:f}),F=setInterval(function(){I&&(I=!1,e.envioMsg(i,{}))},5e3))}var d,e=this,f=30,g=1,h=2,i=3,j=4,k=5,l=6,m=7,n=8,o=9,p=10,q=11,r=12,s=13,t=15,u=16,v=17,w=18,x=19,y=1,z=2,A=3,B=4,C=5,D=2,E=!1,F=!1,G=!1,H=!1,I=!0,J=0;this.onDesconectar=!1,this.onConectar=!1,b(),this.reconectar=function(){F&&clearInterval(F),G&&clearTimeout(G),H&&clearTimeout(H),console.log("FORCANDO RECONEXAO"),G=setTimeout(e.reconectar,6e4);try{E=!1,io.sockets[a].disconnect(),socket.socket.reconnect()}catch(b){}},socket.on("error",function(){console.log("ERRO AO CONECTAR"),G=setTimeout(e.reconectar,1e3)}),socket.on("disconnect",function(){F&&clearInterval(F),G&&clearTimeout(G),H&&clearTimeout(H),J=0,E=!1,console.log("DISCONECTOU"),G=setTimeout(e.reconectar,5e3),e.onDesconectar instanceof Function&&e.onDesconectar()}),socket.on("reconnect_failed",function(){console.log("FALHA NA RECONEXAO")}),socket.on("reconnecting",function(){G&&clearTimeout(G),console.log("INICIANDO RECONEXAO")}),socket.on("reconnect_failed",function(){console.log("FALHA NA RECONEXAO")}),socket.on("connecting",function(){console.log("CONECTANDO")}),socket.on("reconnect",c),socket.on("connect",c),socket.on(g,function(){H&&clearTimeout(H),("telaLobby"==telaAtual||"telaJogo"==telaAtual)&&mudarTela("telaHome",0),e.onConectar instanceof Function&&e.onConectar()}),socket.on(r,function(){H&&clearTimeout(H),e.onConectar instanceof Function&&e.onConectar()}),socket.on(h,function(a){1==a.estado&&mudarTela("telaLobby",1,function(){for(var a=1;3>=a;a++)$("#salas"+a)[0].innerHTML=""})}),socket.on(m,function(a){buraco.acao(a.tipo,a.dados)}),socket.on(n,function(a){$("#loadBg")[0].style.display="none",1==a.estado&&mudarTela("telaLobby","telaJogo"==telaAtual?0:1),buraco.setEstado(a)}),socket.on(v,function(){fecharAlerta(),mudarTela("telaHome",0)}),socket.on(s,function(a){switch(a.tipo){case y:alerta(idioma.PARTIDA_ANDAMENTO,idioma.ESCOLHA_OUTRA_SALA);break;case z:alerta(idioma.NICK_DUPLICADO,idioma.NICK_DUPLICADO_TXT);break;case A:alerta(idioma.SALA_CHEIA,idioma.ESCOLHA_OUTRA_SALA);break;case B:alerta(idioma.ERRO_INICIAR,idioma.ERRO_INICIAR_TXT);break;case C:alerta(idioma.CADASTRO_USO,idioma.CADASTRO_USO_TXT)}}),socket.on(o,function(a){carregarSalas(a)}),socket.on(j,function(a){logarRetorno(a)}),socket.on(l,function(a){cadastrarRetorno(a)}),socket.on(k,function(){deslogarRetorno()}),socket.on(t,function(a){mostrarRank(a)}),socket.on(w,function(a){fecharCarregando(),mudarTela("telaDeslogar",1,null,null,a)}),socket.on(x,function(a){esqueceuSenhaRetorno(a)}),socket.on(i,function(){I=!0,J=0}),this.obterRank=function(a,b){e.envioMsg(t,{tipo:a,inicio:b})},this.obterSalas=function(){e.envioMsg(o,{})},this.entrarSala=function(a,b,c){e.envioMsg(p,{tipo:a,sala:b,nick:c})},this.forcarInicio=function(){e.envioMsg(q,{})},this.logar=function(a,b,c){e.envioMsg(j,{nick:a,senha:b,codigo:c})},this.deslogar=function(){e.envioMsg(k,{})},this.cadastrar=function(a,b,c,d){e.envioMsg(l,{nick:a,email:b,senha:c,avatar:d})},this.esqueceuSenha=function(a,b,c){e.envioMsg(x,{nick:a,email:b,senha:c})},this.editarAvatar=function(a){e.envioMsg(u,{avatar:a})},this.obterDadosUser=function(a){e.envioMsg(w,{usuario:a})},this.envioMsgJogo=function(a,b){e.envioMsg(m,{tipo:a,dados:b})},this.envioMsg=function(a,b){if(socket.socket.connected){console.log("Enviando: "+a+"/"+JSON.stringify(b));try{socket.emit(a,b)}catch(c){console.log("ERRO AO ENVIAR MENSAGEM: "+JSON.stringify(b)),setTimeout(function(){e.envioMsg(a,b)},1e3,a,b)}}}}function Buraco(a,b){function c(){if(P==Mb&&Nb==tb)if(Lb.length>=3||1==Lb.length){a.style.display="block";var b=[];for(var c in Lb)b.push(w(Lb[c]));con.envioMsgJogo(Y,{cartas:b})}else Lb.length&&D.exibirMensagem(idioma.JOGO_TRES_CARTAS)}function d(){P==Mb&&(Nb==sb||Nb==vb?(con.envioMsgJogo(S,{}),Nb=ub,a.style.display="block"):D.exibirMensagem(idioma.JA_COMPROU))}function e(b){if(b==Eb&&P==Mb&&Nb==sb&&Ob.length)con.envioMsgJogo(V,{}),Nb=ub,a.style.display="block";else if(P==Mb&&Nb==tb)if(1==Lb.length){var c=w(Lb[0]);c!=Q||1==Hb[Mb].cartas.length?(con.envioMsgJogo(W,{carta:c}),Nb=ub,a.style.display="block"):D.exibirMensagem(idioma.NAO_PODE_DESCARTAR)}else Lb.length?D.exibirMensagem(idioma.APENAS_UMA_CARTA):b==Eb?D.exibirMensagem(idioma.JA_COMPROU):D.exibirMensagem(idioma.UMA_CARTA);else P==Mb&&Nb==vb&&D.exibirMensagem(idioma.COMPRE_NOVAMENTE)}function f(a){if(P==Mb){1==a.length&&(Q=a[0]),fecharCarregando();for(var b in a){for(var c in Ob)a[b]==Ob[c].cod&&(Hb[Mb].cartas.push(Ob[c]),Ob[c].elem.style.backgroundColor=Rb||b!=a.length-1?"#99FFFF":"#FFFF99",Ob[c].elem.removeEventListener("touchstart",gc),Ob[c].elem.addEventListener("touchstart",u),Pb.push(Ob[c].elem));p(Hb[P].cartas)}}else{var d;for(var b in a)for(var c in Ob)a[b]==Ob[c].cod&&(d=Ob[c],d.elem.removeEventListener("touchstart",gc),d.cod=d.cod.charAt(0),n(d.cod,d.elem,P%2!=Mb%2,!1,!1,!0),Hb[P].cartas.push(d))}Ob=[],console.log(Hb[P].cartas),s(Qb[P],Hb[P].cartas),Nb=tb,r(Gb,"jogada")}function g(a,b){var c=P,d=P==Mb,e=P%2!=Mb%2;_b[b].style.display="none";for(var f in a)Hb[P].cartas.push({cod:a[f],elem:n(a[f],_b[b],e,e,d)});d&&p(Hb[P].cartas),setTimeout(function(){s(Qb[c],Hb[c].cartas,!0)},10)}function h(a,b){_b[a].style.display="none",$b.style.display="block",$b.innerText=11,x(b),M+=0==a?Math.round((I-H)/2):H+Math.round((I-H)/2),t()}function i(){var b=parseInt(this.getAttribute("data-dupla"));if(P==Mb&&Nb==tb&&b==P%2&&Lb.length>0){a.style.display="block";var c=[];for(var d in Lb)c.push(w(Lb[d]));con.envioMsgJogo(Y,{cartas:c,jogo:parseInt(this.getAttribute("data-jogo"))})}else{var e=parseInt(this.getAttribute("data-jogo"));Sb&&clearTimeout(Sb),k(b,0,e),Sb=setTimeout(function(a){k(a,0)},1300,b,e)}}function j(a,b,c){if(0>a)return fecharCarregando(),-2==a?D.exibirMensagem(idioma.JOGO_INVALIDO_LIXO):D.exibirMensagem(idioma.JOGO_INVALIDO),void 0;var d,e,f=[],g=P%2;if(P==Mb){fecharCarregando();for(var h in b){var e=!1;if(Kb[g][a])for(var j in Kb[g][a].cartas)if(Kb[g][a].cartas[j].cod==b[h]){f.push(Kb[g][a].cartas[j]),e=!0;break}if(!e)for(var j in Hb[Mb].cartas)if(b[h]==Hb[Mb].cartas[j].cod){d=Hb[Mb].cartas[j].elem,f.push(Hb[Mb].cartas[j]),Hb[Mb].cartas.splice(j,1),d.setAttribute("data-jogo",a),d.setAttribute("data-dupla",Mb%2),d.removeEventListener("touchstart",u),d.addEventListener("touchstart",i);break}}}else for(var h in b){var e=!1;if(Kb[g][a])for(var j in Kb[g][a].cartas)if(Kb[g][a].cartas[j].cod==b[h]){f.push(Kb[g][a].cartas[j]),e=!0;break}if(!e)for(var j in Hb[P].cartas)if(b[h].charAt(0)==Hb[P].cartas[j].cod){d=Hb[P].cartas[j].elem,Hb[P].cartas[j].cod=b[h],f.push(Hb[P].cartas[j]),n(b[h],d,!1,!1,!1,!0),Hb[P].cartas.splice(j,1),d.setAttribute("data-jogo",a),d.setAttribute("data-dupla",P%2),d.addEventListener("touchstart",i);break}}Kb[g][a]={cartas:f,canastra:{tipo:c,elem:Kb[g][a]?Kb[g][a].canastra.elem:!1}},v(!0),setTimeout(function(a,b,c){s(Qb[a],Hb[a].cartas),k(b,c)},11,P,g,a)}function k(a,b,c){for(var d,e=!1,f=!1,g=a==Mb%2?parseInt(Yb.style.top):parseInt(Xb.style.top),h=(O-I*N)/(N+1),j=G,l=parseInt(Yb.style.left),m=parseInt(Yb.style.width),n=0,p=0;b>p;p++){if(d=H+G,Kb[a][p].cartas.length>1&&(d+=K[a]+L[a]*(Kb[a][p].cartas.length-2)),j+d>m){if(h+=I+(O-I*N)/(N+1),j=G+d,++n>=N)return L[a]?L[a]--:K[a]--,k(a,0),void 0}else j+=d;switch(Kb[a][p].canastra.tipo){case yb:case zb:case Ab:case Bb:f=!0;break;case Cb:e=Kb[a][p].canastra.elem}}for(var p=b;p<Kb[a].length;p++){if(d=H,Kb[a][p].cartas.length>1&&(d+=K[a]+L[a]*(Kb[a][p].cartas.length-2)),j+d+G>m&&(h+=I+(O-I*N)/(N+1),j=G,++n>=N))return L[a]?L[a]--:K[a]--,k(a,0),void 0;if(Kb[a][p].canastra.tipo>xb){var q;switch(Kb[a][p].canastra.elem?(q=Kb[a][p].canastra.elem,bc&&(q.style.webkitTransitionDuration="800ms",q.style.webkitTransitionProperty="top, left, z-index, width")):(q=document.createElement("div"),q.setAttribute("data-jogo",p),q.setAttribute("data-dupla",a),new FastButton(q,i),q.addEventListener("webkitTransitionEnd",o,!0),Wb.appendChild(q),Kb[a][p].canastra.elem=q,bc&&(q.style.display="none",setTimeout(function(a){a.style.display="block"},800,q))),q.style.left=l+j+1+"px",q.style.top=g+h+I-Math.round(I/3)+"px",q.style.height=Math.round(I/3)+"px",q.style.width=d+"px",q.style.zIndex=5+14*p+Kb[a][p].cartas.length,Kb[a][p].canastra.tipo){case yb:q.className="canastra canastraSuja",q.innerText="100",f=!0;break;case zb:q.className="canastra canastraLimpa",q.innerText="200",f=!0;break;case Ab:q.className="canastra canastraQuinhentos",q.innerText="500",f=!0;break;case Bb:q.className="canastra canastraRealissima",q.innerText="1000",f=!0;break;case Cb:f?(q.className="canastra canastraSuja",q.innerText=100*Kb[a][p].cartas.length):(q.className="canastra canastraTres",q.innerText=-100*Kb[a][p].cartas.length),f||(e=q)}}var r=0,s=0,t=0;c==p&&L[a]!=J&&(s=L[a],r=K[a],cartaTopo=h,L[a]=J,K[a]=J,t=1e3);for(var u=0;u<Kb[a][p].cartas.length;u++){var v=Kb[a][p].cartas[u].elem;bc&&(v.style.webkitTransitionDuration="800ms",v.style.webkitTransitionProperty="-webkit-transform, z-index"),v.style.zIndex=5+14*p+u+t,v.style.webkitTransform="translate("+(l+j)+"px,"+(g+h)+"px)",j+=u||1==Kb[a][p].cartas.length?L[a]:K[a]}r&&(L[a]=s,K[a]=r,t=0,j-=J-K[a]+(J-L[a])*(u-1)),j+=H-L[a]+G,f&&e&&(e.className="canastra canastraSuja",e.innerText=e.innerText.replace("-",""))}}function l(a,b,c,d){var e=P;0!=b?$b.innerText=b:$b.style.display="none",x(c);var f=n(a,$b,P%2!=Mb%2,!1,Mb==P);f.style.zIndex=500,P==Mb&&(fecharCarregando(),f.style.backgroundColor="#99FFFF"),Hb[P].cartas.push({cod:a,elem:f}),p(Hb[P].cartas),setTimeout(function(){s(Qb[e],Hb[e].cartas)},10),Mb==P&&Pb.push(f),d||(Nb=tb,r(Gb,"jogada"))}function m(a){var b;if(console.log(P+"/"+Mb),P==Mb){fecharCarregando(),v();for(var c in Hb[Mb].cartas)if(b=Hb[Mb].cartas[c],b.cod==a){b.elem.removeEventListener("touchstart",u),b.elem.addEventListener("touchstart",gc),Ob.push(Hb[Mb].cartas.splice(c,1)[0]);break}s(Qb[P],Hb[P].cartas)}else{for(var c in Hb[P].cartas)if(b=Hb[P].cartas[c],b.cod==a.charAt(0)){Hb[P].cartas.splice(c,1);break}elem=n(a,b.elem,!1,!1,!1,!0),elem.addEventListener("touchstart",gc),Ob.push({cod:a,elem:elem}),s(Qb[P],Hb[P].cartas)}setTimeout(function(){t()},10)}function n(a,b,c,d,e,f){elem=f?b:document.createElement("div"),elem.className="carta",c?(elem.style.width=I+"px",elem.style.height=H+"px",elem.style.border="none",elem.style.borderTop="1px #618663 solid"):(elem.style.width=H+"px",elem.style.height=I+"px",elem.style.border="none",elem.style.borderBottom="1px #618663 solid",elem.style.borderLeft="1px #618663 solid");var g,h,i="";if(a.length>1){switch(a.charAt(1)){case"a":case"b":i=-4*(I+1)-1;break;case"c":i=-3*(I+1)-1;break;case"o":i=-2*(I+1)-1;break;case"e":i=-1*(I+1)-1;break;case"p":i=-1}if(b&&3==bc){elem.style.webkitTransformStyle="preserve-3d",elem.style.webkitTransform="rotateY(180deg)";var j=document.createElement("div");j.className="face back",j.style.backgroundPosition=-1*(parseInt(a.substr(2))-1)*(H+1)-1+"px "+i+"px"}else elem.style.backgroundPosition=-1*(parseInt(a.substr(2))-1)*(H+1)-1+"px "+i+"px"}else 1==a.charAt(0)?c?(elem.style.backgroundPosition="-"+(5*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",elem.className="cartaViradaH"):(elem.style.backgroundPosition="-"+(3*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",elem.className="cartaViradaV"):c?(elem.style.backgroundPosition="-"+(5*(H+1)+1+I+1)+"px -"+(4*(I+1)+1)+"px",elem.className="cartaViradaH"):(elem.style.backgroundPosition="-"+(4*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",elem.className="cartaViradaV");return d?(2==bc&&(elem.style.webkitTransform="rotate(90deg)"),g=parseInt(b.style.top)+(I-H)/2+"px",h=parseInt(b.style.left)+(H-I)/2+"px"):(g=b.style.top,h=b.style.left),elem.style.webkitTransform="translate("+h+","+g+")",e&&elem.addEventListener("touchstart",u),elem.addEventListener("webkitTransitionEnd",o,!0),f||Wb.appendChild(elem),elem}function o(a){var b=a.srcElement;a.propertyName,b.style.webkitTransitionDelay="",b.style.webkitTransitionTimingFunction="",b.style.webkitTransitionProperty="",b.style.webkitTransitionDuration=""}function p(a){a=a.sort(function(a,b){return a.cod.charAt(1)!=b.cod.charAt(1)?a.cod.charAt(1)>b.cod.charAt(1)?1:-1:parseInt(a.cod.substr(2))-parseInt(b.cod.substr(2))})}function q(){P=-1,Nb=ub,D.zerarTela(),K=[J,J],L=[J,J],M=parseInt(Zb.style.width)-(H+I+4*G),D.onIniciarJogo instanceof Function&&D.onIniciarJogo(),ac.style.display="none",$("#tempoBaixo div")[0].style.display="none",$("#tempoCima div")[0].style.display="none",$("#tempoDireita div")[0].style.display="none",$("#tempoEsquerda div")[0].style.display="none";for(var a in Hb[Mb].cartas)Hb[Mb].cartas[a].elem=n(Hb[Mb].cartas[a].cod,$b,!1,!1,!0);p(Hb[Mb].cartas);for(var b=0;b<Hb.length;b++)if(Mb!=b){for(var a in Hb[b].cartas)Hb[b].cartas[a].elem=n(Hb[b].cartas[a].cod,$b,b%2!=Mb%2,b%2!=Mb%2);p(Hb[b].cartas)}setTimeout(function(){s(nb,Hb[Mb].cartas,!0),s(pb,Hb[(Mb+1)%4].cartas,!0),s(ob,Hb[(Mb+2)%4].cartas,!0),s(qb,Hb[(Mb+3)%4].cartas,!0)},10)}function r(a,b,c){for(var d,e=["tempoBaixo","tempoEsquerda","tempoCima","tempoDireita"],f=(4+P-Mb)%4,g=$("#"+e[f])[0],h=0;h<e.length;h++)d=$("#"+e[h])[0],d.childNodes[0].style.webkitTransitionProperty="",d.childNodes[0].style.webkitTransitionDuration="",d.childNodes[0].style.webkitTransitionTimingFunction="",d.childNodes[0].style.display="none";c||0===c?(a=Math.round(a*c),c=Math.round(100*c)+"%",console.log(c)):c="100%",P%2==Mb%2?g.childNodes[0].style.width=c:g.childNodes[0].style.height=c,g.childNodes[0].className=b,g.childNodes[0].style.display="block",setTimeout(function(b,c){c.childNodes[0].style.webkitTransitionDuration=a+"ms",c.childNodes[0].style.webkitTransitionTimingFunction="linear",b%2==Mb%2?(c.childNodes[0].style.webkitTransitionProperty="width",c.childNodes[0].style.width="0%"):(c.childNodes[0].style.webkitTransitionProperty="height",c.childNodes[0].style.height="0%")},0,P,g)}function s(a,b,c,d){for(var e,f,g,h,i,j,k,l,m=b.length,n=0;m>n;n++){switch(k=[0,0],l="",e=b[n],e.elem.style.zIndex=200+n,!d&&bc&&(e.elem.style.webkitTransitionDuration="800ms",c&&(e.elem.style.webkitTransitionDelay=100*(b.length-n)+"ms"),e.elem.style.webkitTransitionProperty="-webkit-transform, z-index"),a){case nb:k[1]=F-I-G+"px",f=E,g=0,i=0,j=H;break;case ob:k[1]="-"+Math.round(3*I/4)+"px",f=E,h=G,g=2*h,i=0,j=H;break;case pb:k[0]="-"+Math.round(3*I/4)+"px",f=F,h=I/4+G,g=2*G+I+h,i=1,j=H,c&&2==bc&&(e.elem.style.webkitTransform="rotate(0deg)");break;case qb:k[0]=E-Math.round(I/4)+"px",f=F,h=I/4+G,g=2*G+I+h,i=1,j=H,c&&2==bc&&(e.elem.style.webkitTransform="rotate(0deg)")}var o=f-g-j*m;if(a==nb)k[i]=o>0?Math.round(o/(m+1)*(n+1)+j*n)+"px":Math.round(o/m*n+j*n)+"px";else if(o/(m-1)>-1*j/2){var p=(f-g)/2;k[i]=Math.round(h+p+(n-(m+1)/2)*j/2)+"px"}else k[i]=Math.round(h+o/(m-1)*n+j*n)+"px";e.elem.style.webkitTransform="translate("+k.join(",")+")"+l}}function t(a){var b,c;Rb?(c=(M-H*Ob.length)/(Ob.length-1),c>-H/2&&(c=-H/2)):c=-H+2;for(var d=0;d<Ob.length;d++)b=Ob[d].elem,!a&&bc&&(b.style.webkitTransitionProperty="-webkit-transform",b.style.webkitTransitionDuration="800ms"),b.style.webkitTransform="translate("+(parseInt(Zb.style.left)+H+9+(H+c)*d)+"px,"+(parseInt(Zb.style.top)+3)+"px)",b.style.zIndex=100+d}function u(){if(Nb==tb&&P==Mb)if(this.className.match(/cartaSel/)){this.style.marginTop="",this.className="carta";for(ind in Lb)if(Lb[ind]==this){Lb.splice(ind,1);break}}else this.style.marginTop="-"+G+"px",this.className+=" cartaSel",Lb.push(this);else P!=Mb||(Nb==sb?D.exibirMensagem(idioma.COMPRAR_ANTES_JOGAR):Nb==vb&&D.exibirMensagem(idioma.COMPRE_NOVAMENTE,!0))}function v(a){for(var b=0;b<Lb.length;b++)Lb[b].style.marginTop="",Lb[b].style.backgroundColor="#FFF",Lb[b].className="carta";if(Lb=[],!a){for(var b=0;b<Pb.length;b++)Pb[b].style.marginTop="",Pb[b].style.backgroundColor="#FFF";Pb=[]}}function w(a){for(var b=0;b<Hb[Mb].cartas.length;b++)if(Hb[Mb].cartas[b].elem==a)return Hb[Mb].cartas[b].cod;return!1}function x(a){$b.style.backgroundPosition=1==a?"-"+(3*(H+1)+1)+"px -"+(4*(I+1)+1)+"px":"-"+(4*(H+1)+1)+"px -"+(4*(I+1)+1)+"px"}function y(){for(var a in Hb){var b=(4+(a-Mb))%4;0!=b&&($("#jogadorNick"+b)[0].innerText=z(a))}}function z(a){var b;return b=Hb[a].user?Hb[a].user.nick:"BOT "+a}function A(a,b,c){if(!localStorage.chatOff){console.log(Mb+"//"+a),a=(4+(a-Mb))%4,Tb[a]&&clearTimeout(Tb[a]);var d=$("#opcoesTela>.historico>div")[0],e=document.createElement("div");e.innerHTML="<span>"+b+":</span> "+c,d.appendChild(e),d.childNodes.length>10&&d.removeChild(d.firstChild);var f=$("#chat"+a)[0];f.style.display="block",f.innerHTML="<strong>"+b+"</strong>: "+c,Tb[a]=setTimeout(function(a){D.fecharBalao(a)},4e3,a)}}function B(){alerta(idioma.INATIVO,idioma.INATIVO_TXT,function(){fecharAlerta(),a.style.display="block",con.envioMsgJogo(mb,{})})}function C(a){fecharAlerta(),$("#tempoBaixo div")[0].style.display="none",$("#tempoCima div")[0].style.display="none",$("#tempoDireita div")[0].style.display="none",$("#tempoEsquerda div")[0].style.display="none";var b=a.totais[Mb%2]>a.totais[(Mb+1)%2]?idioma.VENCEU:a.totais[Mb%2]<a.totais[(Mb+1)%2]?idioma.PERDEU:idioma.EMPATOU;0==Mb%2?D.exibirMensagem(idioma.FIM_PARTIDA+b+"<br />"+idioma.SUA_DUPLA+a.totais[0]+"<br />"+idioma.ADVERSARIOS+a.totais[1],!0):D.exibirMensagem(idioma.FIM_PARTIDA+b+"<br />"+idioma.SUA_DUPLA+a.totais[1]+"<br />"+idioma.ADVERSARIOS+a.totais[0],!0),Nb=wb}var D=this;D.onIniciarJogo=null,D.onAlteraJogadores=null,D.onSairJogo=null;var E,F,G,H,I,J,K,L,M,N,O,P,Q,R=1,S=2,T=3,U=4,V=5,W=7,X=8,Y=10,Z=11,_=12,ab=13,bb=15,cb=16,db=17,eb=18,fb=19,gb=20,hb=22,ib=23,jb=24,kb=27,lb=25,mb=26,nb=0,ob=1,pb=2,qb=3,rb=1,sb=2,tb=3,ub=4,vb=5,wb=6,xb=2,yb=3,zb=4,Ab=5,Bb=6,Cb=7,Db=1,Eb=2,Fb=3e4,Gb=6e4,Hb=[{user:void 0,cartas:[]},{user:void 0,cartas:[]},{user:void 0,cartas:[]},{user:void 0,cartas:[]}],Ib="",Jb=new Sons(b),Kb=[[],[]],Lb=[],Mb=-1,Nb=rb,Ob=[],Pb=[],Qb=[],Rb=!0,Sb=!1,Tb=[!1,!1,!1,!1],Ub=!1,Vb=!1,Wb=$("#jogo")[0],Xb=$("#jogosD1")[0],Yb=$("#jogosD2")[0],Zb=$("#lixo")[0],$b=$("#monte")[0],_b=[$("#morto1")[0],$("#morto2")[0]],ac=$("#mensagem")[0],bc=1,cc=bc;new FastButton(Yb,c),new FastButton(Zb,function(){e(Db)}),new FastButton($b,d),new FastButton($("#sair")[0],function(){var a=function(){fecharAlerta(),D.fecharOpcoes(),con.envioMsgJogo(fb,{}),D.onSairJogo instanceof Function&&D.onSairJogo()};Nb==wb?a():confirma(idioma.SAIR_JOGO,idioma.SAIR_JOGO_TXT,a)}),new FastButton($("#opcoes")[0],function(){a.style.display="block",a.style.backgroundColor="rgba(0,0,0,0.5)",$("#opcoesTela")[0].style.display="block"});var dc=$("#ativarSom")[0];dc.addEventListener("touchstart",function(){Jb.getAtivo()?(Jb.desativar(),this.className="desativar",localStorage.somOff=!0):(Jb.ativar(),this.className="ativar",localStorage.removeItem("somOff"))}),localStorage.somOff?(dc.className="desativar",Jb.desativar()):(dc.className="ativar",Jb.ativar()),delete dc;var ec=$("#ativarChat")[0];ec.addEventListener("touchstart",function(){localStorage.chatOff?(this.className="ativar",localStorage.removeItem("chatOff"),$("#opcoesTela>form>input")[0].disabled=""):(this.className="desativar",localStorage.chatOff=!0,$("#opcoesTela>form>input")[0].disabled="disabled")}),localStorage.chatOff?(ec.className="desativar",$("#opcoesTela>form>input")[0].disabled="disabled"):ec.className="ativar",delete ec;var fc=$("#ativarNomes")[0];fc.addEventListener("touchstart",function(){localStorage.nomeOn?(this.className="desativar",localStorage.removeItem("nomeOn"),$("#jogadorNick1")[0].style.display="none",$("#jogadorNick2")[0].style.display="none",$("#jogadorNick3")[0].style.display="none"):(this.className="ativar",localStorage.nomeOn=!0,$("#jogadorNick1")[0].style.display="block",$("#jogadorNick2")[0].style.display="block",$("#jogadorNick3")[0].style.display="block")}),localStorage.nomeOn?(fc.className="ativar",$("#jogadorNick1")[0].style.display="block",$("#jogadorNick2")[0].style.display="block",$("#jogadorNick3")[0].style.display="block"):(fc.className="desativar",$("#jogadorNick1")[0].style.display="none",$("#jogadorNick2")[0].style.display="none",$("#jogadorNick3")[0].style.display="none"),delete fc;var gc=function(){e(Eb)};D.setDimensoes=function(a){E=a.telaLargura,F=a.telaAltura,G=a.telaMargem,H=a.cartaLargura,I=a.cartaAltura,J=Math.round(a.cartaLargura/4),K=[J,J],L=[J,J],Wb.style.width=E+"px",Wb.style.height=F+"px";var b=$("#tempoCima")[0],c=$("#tempoBaixo")[0],d=$("#tempoEsquerda")[0],e=$("#tempoDireita")[0];Xb.style.fontSize=a.fontSize+"px",Yb.style.fontSize=a.fontSize+"px",Zb.style.fontSize=a.fontSize+"px",bc=1;var f=I+2*G;Xb.style.top=Math.round(I/4+G)+"px",Xb.style.left=Xb.style.top,O=(F-parseInt(Xb.style.top)-2-f-(I+2*G))/2,Xb.style.paddingTop=Math.round((O-a.fontSize)/2)+"px",Xb.style.width=Math.round(E-2*(I/4+G))+"px",Xb.style.height=O-parseInt(Xb.style.paddingTop)+"px",Zb.style.top=parseInt(Xb.style.top)+O+1+"px",Zb.style.left=Xb.style.left,Zb.style.width=Xb.style.width,Zb.style.paddingTop=Math.round((f-a.fontSize)/2)+"px",Zb.style.height=f-parseInt(Zb.style.paddingTop)+"px",Yb.style.top=parseInt(Zb.style.top)+f+1+"px",Yb.style.left=Xb.style.left,Yb.style.paddingTop=Xb.style.paddingTop,Yb.style.width=Xb.style.width,Yb.style.height=Xb.style.height,b.style.top=Math.round(I/4+1)+"px",b.style.left=Math.round(I/4+G)+"px",b.style.width=E-2*parseInt(b.style.left)+"px",c.style.top=F-(I+2*G)+"px",c.style.left=Math.round(G/2)+"px",c.style.width=E-G+"px",d.style.top=Math.round(I/4+G)+"px",d.style.left=b.style.top,d.style.height=F-parseInt(d.style.top)-(I+2*G)+"px",e.style.top=d.style.top,e.style.right=d.style.left,e.style.height=d.style.height,ac.style.bottom=I+3*G+"px",ac.style.left=parseInt(Xb.style.left)+G+"px",ac.style.width=parseInt(Xb.style.width)-2*G-10+"px",ac.style.fontSize=a.fontSize+"px",$b.style.top=parseInt(Zb.style.top)+G+"px",$b.style.left=parseInt(Zb.style.left)+G+"px",$b.style.fontSize=a.fontSize+"px",$b.style.paddingTop=Math.round((I-a.fontSize)/2)+"px",$b.style.height=I-parseInt($b.style.paddingTop)+"px",$b.style.width=H+"px",$b.style.backgroundPosition="-"+(4*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",_b[1].style.top=parseInt(Zb.style.top)+G+"px",_b[1].style.left=parseInt(Zb.style.left)+parseInt(Zb.style.width)-(H+(I-H)/2+G)+"px",_b[1].style.width=H+"px",_b[1].style.height=I+"px",_b[1].style.backgroundPosition="-"+(4*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",_b[0].style.top=parseInt(Zb.style.top)+(I-H)/2+G+"px",_b[0].style.left=parseInt(Zb.style.left)+parseInt(Zb.style.width)-I-G+"px",_b[0].style.width=I+"px",_b[0].style.height=H+"px",_b[0].style.backgroundPosition="-"+(5*(H+1)+1)+"px -"+(4*(I+1)+1)+"px",M=parseInt(Zb.style.width)-(H+I+4*G),N=Math.floor(O/I),N||(N=1),Qb[Mb]=nb,Qb[(Mb+1)%4]=pb,Qb[(Mb+2)%4]=ob,Qb[(Mb+3)%4]=qb,bc=0,Mb>=0&&(s(nb,Hb[Mb].cartas,!0,!0),s(pb,Hb[(Mb+1)%4].cartas,!0,!0),s(ob,Hb[(Mb+2)%4].cartas,!0,!0),s(qb,Hb[(Mb+3)%4].cartas,!0,!0)),t(!0),k(0,0),k(1,0),setTimeout(function(){bc=cc},10)},D.setCartas=function(a,b,c){for(var d=0;d<Hb.length;d++){Hb[d].cartas=[];for(var e=0;e<a[d].length;e++)Hb[d].cartas[e]={cod:a[d][e],elem:void 0}}$b.innerText=b,x(c),q()},D.setPosicao=function(a){Mb=a,Qb[Mb]=nb,Qb[(Mb+1)%4]=pb,Qb[(Mb+2)%4]=ob,Qb[(Mb+3)%4]=qb},D.getPosicao=function(){return Mb},D.setVez=function(a,b,c){a==Mb?(Jb.play("jogadorVez"),v(),Q="",D.exibirMensagem(idioma.SUA_VEZ)):D.exibirMensagem(idioma.VEZ_DE+z(a)),P=a,Pb=[],Nb=c?c:sb,Nb==sb?r(Fb,"compra",b):r(Gb,"jogada",b)},D.setJogador=function(a,b,c,d){Hb[b]&&(Hb[b].user={nick:a,pontuacao:c,avatar:d},$("#jogadorNick"+(4+(b-Mb))%4)[0].innerText=a,D.onAlteraJogadores instanceof Function&&D.onAlteraJogadores(Hb))},D.exibirMensagem=function(a,b){Nb!=wb&&(Ub&&clearTimeout(Ub),ac.style.display="block",ac.innerHTML=a,b||(Ub=setTimeout(function(){ac.style.display="none"},1800)))},D.fecharMensagem=function(){ac.style.display="none"},D.setLixo=function(a){Ob=[];var b;for(var c in a)b={cod:a[c],elem:n(a[c],$b,!1,!1,!1)},b.elem.addEventListener("touchstart",gc),Ob.push(b);t()},D.setJogos=function(a){Kb=[[],[]];var b;for(var c in a){for(var d in a[c]){Kb[c][d]={cartas:[],canastra:{tipo:a[c][d].canastra,elem:!1}};for(var e in a[c][d].cartas)b=n(a[c][d].cartas[e],$b,!1,!1,!1),b.setAttribute("data-jogo",d),b.setAttribute("data-dupla",c),b.addEventListener("touchstart",i),Kb[c][d].cartas[e]={cod:a[c][d].cartas[e],elem:b}}k(c,0)}},D.setEstado=function(a){Nb=a.estado;for(var b in Hb)Hb[b].user=void 0;D.setPosicao(a.posicao),D.setLixoAberto(a.lixoAberto);for(var b in a.jogadores)Hb[a.jogadores[b].posicao].user={nick:a.jogadores[b].nick,pontuacao:a.jogadores[b].pontuacao,confirmacao:a.jogadores[b].conf,avatar:a.jogadores[b].avatar};if(y(),$("#telaLobby h1")[0].innerText=a.sala,Nb!=rb){bc=0,D.zerarTela(),D.setCartas(a.cartas,a.monte,a.monteCor),D.setLixo(a.lixo),D.setJogos(a.jogos),D.setVez(a.vez,a.tempo,a.estado);for(var c=0;c<2-a.mortos;c++)_b[c].style.display="none";a.inativoForcado&&setTimeout(function(){B()},2e3),setTimeout(function(){bc=cc},11)}D.onAlteraJogadores instanceof Function&&D.onAlteraJogadores(Hb,a.tempo)},D.getNome=function(){return Ib},D.confirmacao=function(a,b){Hb[a].user.confirmacao=b,D.onAlteraJogadores instanceof Function&&D.onAlteraJogadores(Hb)},D.zerarTela=function(){Ob=[],Kb=[[],[]],Lb=[],Pb=[],$("#opcoesTela .historico div")[0].innerHTML="";for(var a=$(".carta, .cartaViradaH, .cartaViradaV, .canastra"),b=0;b<a.length;b++)Wb.removeChild(a[b]);_b[0].style.display="block",_b[1].style.display="block",$b.style.display="block"},D.numJogadores=function(){var a=0;for(var b in Hb)Hb[b].user&&a++;return a},D.getEstado=function(){return Nb},D.setLixoAberto=function(a){Rb=a},D.repetir=function(){Nb=vb,D.exibirMensagem(idioma.COMPRE_NOVAMENTE),fecharCarregando(),r(Fb,"compra")},D.fecharBalao=function(a){Tb[a]&&clearTimeout(Tb[a]),$("#chat"+a)[0].style.display="none"},D.enviarChat=function(){if(!Vb){var a=$("#opcoesTela>form>input")[0];a.value.length&&(con.envioMsgJogo(db,{msg:a.value}),Vb=!0,setTimeout(function(){Vb=!1},7e3),D.fecharOpcoes(),a.blur())}},D.fecharChat=function(){$("#telaChat input")[0].value="",$("#telaChat")[0].style.display="none",$("#chat")[0].style.backgroundPosition="-163px -141px"},D.fecharOpcoes=function(){$("#opcoesTela>form>input")[0].value="",$("#opcoesTela")[0].style.display="none","block"!=$("#alerta")[0].style.display&&(a.style.display="none",a.style.backgroundColor="rgba(255,255,255,0.5)")},D.inativar=function(a){D.exibirMensagem(Hb[a].user.nick+idioma.ESTA_INATIVO)},D.sair=function(a){Nb!=wb&&(D.exibirMensagem(Hb[a].user.nick+idioma.SAIU_JOGO),Hb[a].user=void 0,y(),D.onAlteraJogadores instanceof Function&&D.onAlteraJogadores(Hb))},D.acao=function(a,b){switch(a){case S:Jb.play("comprarCarta"),l(b.carta,b.quant,b.monteCor,b.manterEstado);break;case T:Ib=b.sala,D.setJogador(b.nick,b.posicao,b.pontuacao,b.avatar);break;case X:D.setCartas(b.cartas,b.monte,b.monteCor);break;case U:D.setVez(b.vez);break;case W:Jb.play("descerLixo"),m(b.carta);break;case V:Jb.play("comprarCarta"),f(b.cartas);break;case Y:Jb.play("descerJogo"),j(b.cod,b.cartas,b.canastra);break;case Z:g(b.cartas,b.morto);break;case ab:h(b.morto,b.monteCor);break;case _:C(b);break;case db:A(b.pos,b.nick,b.msg);break;case eb:D.confirmacao(b.pos,b.val);break;case bb:D.exibirMensagem(idioma.LIMPA_PARA_BATER),fecharCarregando();break;case cb:D.exibirMensagem(idioma.SUJA_PARA_BATER),fecharCarregando();break;case gb:D.exibirMensagem(idioma.NAO_BATER_LIXO),fecharCarregando();break;case jb:D.exibirMensagem(idioma.NAO_COMPRAR_LIXO),fecharCarregando(),Nb=sb;break;case kb:D.exibirMensagem(idioma.NAO_COMPRAR_LIXO),fecharCarregando(),Nb=sb;break;case ib:D.exibirMensagem(idioma.JUSTIFICAR_LIXO),fecharCarregando(),Nb=tb;break;case lb:D.exibirMensagem(idioma.PERDEU_RODADA,!0),fecharCarregando(),v(!0);break;case hb:D.inativar(b.pos);break;case mb:b.inativo?B():fecharCarregando();break;case fb:D.sair(b.pos);break;case R:D.repetir()}}}function blockScroll(a){parseInt(document.body.scrollTop)>1&&window.scrollTo(0,1),a.preventDefault()}function onBackButton(a){try{a.preventDefault(),navigator.notification.confirm(idioma.SAIR_APP,checkButtonSelection,idioma.SAIR,idioma.CANCELAR+","+idioma.OK)}catch(a){console.log("Exception: "+a,3)}}function checkButtonSelection(a){2==a&&navigator.app.exitApp()}function shouldRotateToOrientation(a){switch(a){case 0:case 180:return!0;case 90:case-90:return!1}}function iniciarConexao(){$("#nick")[0].value=window.localStorage.getItem("nick")?window.localStorage.getItem("nick"):window.localStorage.setItem("nick",idioma.ANONIMO+Math.round(1e4*Math.random())),timerInicio&&clearTimeout(timerInicio),timerInicio=setTimeout(function(){window.scrollTo(0,1),con=new Conexao("http://www.buracoon.com.br:9334"),con.onConectar=function(){window.localStorage.getItem("codigo")?con.logar(window.localStorage.getItem("nick"),void 0,window.localStorage.getItem("codigo")):fecharCarregando(),fecharAlerta(),navigator.splashscreen.hide()
},con.onDesconectar=function(){aviso(idioma.RECONECTANDO),fecharCarregando()},buraco=new Buraco(carregandoElem,loader.getSons()),buraco.onIniciarJogo=function(){mudarTela("telaJogo",1)},buraco.onSairJogo=function(){mudarTela("telaHome",0)},buraco.onAlteraJogadores=atualizarJogadores,mudarDimensao(),window.addEventListener("resize",mudarDimensao,!0)},100)}function mudarDimensao(){"telaJogar"==telaAtual&&myScroll.refresh(),!buraco||tamanhoHorizontal==window.innerWidth&&tamanhoVertical==telaRolagem.offsetHeight||(tamanhoHorizontal=window.innerWidth,tamanhoVertical=telaRolagem.offsetHeight,410>tamanhoVertical&&($("#opIcone")[0].style.display="none"),buraco.setDimensoes({telaLargura:tamanhoHorizontal,telaAltura:418>tamanhoVertical?418:tamanhoVertical,telaMargem:4,cartaLargura:46,cartaAltura:63,fontSize:15}))}function $(a){var b=document.querySelectorAll(a);return b?b:{}}function mudarTela(a,b,c,d,e){if(a!=telaAtual&&!travarBotao&&a!=telaAtual){switch(telaAnterior=telaAtual,telaAtual=a,travarBotao=!0,telaAtual){case"telaHome":c=function(){setTimeout(function(){$("#telaHome")[0].className="tela animacao"},0)};break;case"telaSobre":$("#"+telaAtual)[0].innerHTML=loader.getPage("sobre"),new FastButton($("#btSobre0")[0],function(){selSobre(0)}),new FastButton($("#btSobre1")[0],function(){selSobre(1)}),new FastButton($("#telaSobre .back")[0],function(){mudarTela("telaHome",0)});break;case"telaRanking":$("#"+telaAtual)[0].innerHTML=loader.getPage("ranking"),myScroll=new iScroll("scrollRank",{fixedScrollbar:!1,hideScrollbar:!0}),new FastButton($("#btRank1")[0],function(){selRank(1)}),new FastButton($("#btRank3")[0],function(){selRank(3)}),new FastButton($("#btRank4")[0],function(){selRank(4)}),new FastButton($("#telaRanking .back")[0],function(){mudarTela("telaHome",0)}),c=function(){selRank(1)};break;case"telaCadastro":$("#"+telaAtual)[0].innerHTML=loader.getPage("cadastro"),$("#cadAvatar")[0].style.backgroundImage="url(imgs/avatar/"+avatarNum+".jpg)",new FastButton($("#telaCadastro .back")[0],function(){mudarTela("telaLogin",0)});break;case"telaLogin":$("#"+telaAtual)[0].innerHTML=loader.getPage("login"),new FastButton($("#telaLogin .back")[0],function(){mudarTela("telaHome",0)});break;case"telaSenha":$("#"+telaAtual)[0].innerHTML=loader.getPage("senha"),new FastButton($("#telaSenha .back")[0],function(){mudarTela("telaLogin",0)});break;case"telaJogar":$("#"+telaAtual)[0].innerHTML=loader.getPage("jogar"),new FastButton($("#telaJogar .back")[0],function(){mudarTela("telaHome",0)}),myScroll=new iScroll("scroll",{fixedScrollbar:!1,hideScrollbar:!0}),con.obterSalas(),timerRefresh&&clearInterval(timerRefresh),timerRefresh=setInterval(function(){con.obterSalas()},6e3);break;case"telaLobby":$("#telaLobby .back")[0].fastbutton||($("#telaLobby .back")[0].fastbutton=new FastButton($("#telaLobby .back")[0],function(){mudarTela("telaJogar",0,sairJogo)})),$("#btPreparado")[0].value=idioma.ESTOU_PREPARADO,$("#btPreparado")[0].fastbutton&&$("#btPreparado")[0].fastbutton.destroy(),$("#btPreparado")[0].fastbutton=new FastButton($("#btPreparado")[0],function(){lobbyPreparado(!0)}),$("#btForcarInicio")[0].style.display="none";break;case"telaDeslogar":usuarioAlvo=e,$("#"+telaAtual)[0].innerHTML=loader.getPage("perfil"),usuarioAlvo?($("#avatarGrande")[0].style.backgroundImage=usuarioAlvo.avatar?"url(imgs/avatar/"+usuarioAlvo.avatar+".jpg)":"url(http://gartic.com.br/avatar.php?nick="+usuarioAlvo.nick+")",$("#telaDeslogar h2")[0].innerHTML=usuarioAlvo.nick,$("#perfilPontuacao")[0].innerHTML=usuarioAlvo.pontuacao,$("#perfilVitorias")[0].innerHTML=usuarioAlvo.vitorias,$("#perfilDerrotas")[0].innerHTML=usuarioAlvo.derrotas,$("#perfilAbandonos")[0].innerHTML=usuarioAlvo.abandonos,$("#telaDeslogar .editarAvatar")[0].style.visibility="hidden",$("#btDeslogar")[0].style.display="none",$("#telaDeslogar .back")[0].fastbutton&&$("#telaDeslogar .back")[0].fastbutton.destroy(),$("#telaDeslogar .back")[0].fastbutton=new FastButton($("#telaDeslogar .back")[0],function(){mudarTela("telaRanking",0)}),usuarioAlvo=!1):usuario&&($("#avatarGrande")[0].style.backgroundImage="url("+imgAvatar.src+")",$("#telaDeslogar h2")[0].innerHTML=usuario.login,$("#perfilPontuacao")[0].innerHTML=usuario.pontuacao,$("#perfilVitorias")[0].innerHTML=usuario.vitorias,$("#perfilDerrotas")[0].innerHTML=usuario.derrotas,$("#perfilAbandonos")[0].innerHTML=usuario.abandonos,$("#telaDeslogar .editarAvatar")[0].style.visibility="visible",$("#btDeslogar")[0].style.visibility="block",$("#telaDeslogar .back")[0].fastbutton&&$("#telaDeslogar .back")[0].fastbutton.destroy(),$("#telaDeslogar .back")[0].fastbutton=new FastButton($("#telaDeslogar .back")[0],function(){mudarTela("telaHome",0)}));break;case"telaJogo":timerRefresh&&clearInterval(timerRefresh)}"telaHome"==telaAnterior?($("#telaHome")[0].className="tela",$("#logo")[0].className=""):"telaJogo"==telaAnterior?(buraco.fecharOpcoes(),timerRefresh&&clearInterval(timerRefresh)):"telaJogar"==telaAnterior&&timerRefresh&&clearInterval(timerRefresh),window.scrollTo(0,1);var f;f=function(){switch(telaAnterior){case"telaRanking":case"telaJogar":myScroll.destroy();case"telaSenha":case"telaSobre":case"telaCadastro":case"telaLogin":case"telaDeslogar":$("#"+telaAnterior)[0].innerHTML="";break;case"telaJogo":buraco.zerarTela()}"telaJogar"==telaAtual&&myScroll.refresh(),rolagemElem.className="",$("#"+telaAnterior)[0].style.display="none",rolagemElem.removeEventListener("webkitTransitionEnd",f,!1),c instanceof Function&&c(),abrindo=!1,travarBotao=!1},rolagemElem.addEventListener("webkitTransitionEnd",f,!1),$("#"+telaAtual)[0].style.display="inline",rolagemElem.className=b?"rolagemDir":"rolagemEsq",fecharCarregando()}}function abrirTipo(a){if(!abrindo){abrindo=!0;var b=$("#detalhesTipo"+a)[0];b.style.display="block";var c=b.scrollHeight,d=$("#scroll div")[0].scrollHeight;parseInt(b.style.height)?(b.addEventListener("webkitTransitionEnd",fimAbrirTipo,!0),$("#tipo"+a)[0].className="salaTipo",b.style.height="0px",d-=c,$("#scroll div")[0].style.height=d+"px"):(b.addEventListener("webkitTransitionEnd",fimAbrirTipo2,!0),setTimeout(function(a,b,c,d){$("#tipo"+d)[0].className="salaTipo sel",a.style.webkitTransitionDuration=Math.floor(1.5*b)+"ms",a.style.height=b+"px",c+=b,$("#salas"+d)[0].childNodes.length||(carregandoElem.style.display="block"),$("#scroll div")[0].style.height=c+"px"},10,b,c,d,a)),$("#scroll div")[0].style.height=d+"px",setTimeout(function(){myScroll.refresh()},15)}}function fimAbrirTipo(){this.style.display="none",this.removeEventListener("webkitTransitionEnd",fimAbrirTipo,!0),abrindo=!1}function fimAbrirTipo2(){this.removeEventListener("webkitTransitionEnd",fimAbrirTipo,!0),abrindo=!1}function carregarSalas(a){var b,c,d,e=["","salas1","salas2","salas3","salas4","salas5","salas6"];$("#salas1")[0].childNodes.length||fecharCarregando();for(var f=1;f<e.length;f++){$("#"+e[f])[0].innerHTML="",$("#tipo"+f+" .usuarios")[0].innerHTML=a[f].total;for(var g=0;g<a[f].salas.length;g++)elemSala=document.createElement("div"),elemSala.className=g%2?"linhaPar":"linhaImpar",elemSala.setAttribute("tipo",f+"-"+(void 0!==a[f].salas[g].num?a[f].salas[g].num:g)),b=document.createElement("div"),b.className="titulo",b.innerHTML="Sala "+a[f].salas[g].nome,c=document.createElement("div"),c.className=0==a[f].salas[g].quant?"boneco":4==a[f].salas[g].quant?"boneco cheio":"boneco espera",d=document.createElement("div"),d.className="quant",d.innerHTML=a[f].salas[g].quant,elemSala.appendChild(b),elemSala.appendChild(c),elemSala.appendChild(d),$("#"+e[f])[0].appendChild(elemSala),elemSala.onclick=function(){if(!abrindo){abrindo=!0;var a=this.getAttribute("tipo");a=a.split("-"),carregandoElem.style.display="block",con.entrarSala(parseInt(a[0]),parseInt(a[1]),window.localStorage.getItem("nick"))}};setTimeout(function(a){var b=$("#detalhesTipo"+a)[0],c=$("#scroll div")[0].scrollHeight;if(parseInt(b.style.height)&&parseInt(b.style.height)<b.scrollHeight){var d=b.scrollHeight-parseInt(b.style.height);b.style.height=b.scrollHeight+"px",c+=d,$("#scroll div")[0].style.height=c+"px",setTimeout(function(){myScroll.refresh()},10)}},10,f)}}function jogarDireto(a,b){abrindo||(abrindo=!0,carregandoElem.style.display="block",con.entrarSala(b,void 0,window.localStorage.getItem("nick")),a.stopPropagation&&a.stopPropagation())}function lobbyPreparado(a){var b=$("#btPreparado")[0];a?(b.value=idioma.NAO_ESTOU_PREPARADO,b.fastbutton&&b.fastbutton.destroy(),b.fastbutton=new FastButton(b,function(){lobbyPreparado(!1)}),con.envioMsgJogo(18,{valor:!0})):(b.value=idioma.ESTOU_PREPARADO,b.fastbutton&&b.fastbutton.destroy(),b.fastbutton=new FastButton(b,function(){lobbyPreparado(!0)}),con.envioMsgJogo(18,{valor:!1}))}function atualizarJogadores(a,b){var c;if(1==buraco.getEstado()){for(var d in a)a[d].user?($("#nick"+d)[0].style.opacity="1","*"!=a[d].user.nick.charAt(0)?($("#nick"+d+" .nick")[0].className="nick",$("#nick"+d+" .nick")[0].innerHTML="<div>"+a[d].user.nick+"</div>"+a[d].user.pontuacao+" pts",$("#nick"+d+" .imagem")[0].style.backgroundPosition="center center",c=a[d].user.avatar?"url(imgs/avatar/"+a[d].user.avatar+"_min.jpg)":"url(http://www.gartic.com.br/avatar.php?tipo=min&nick="+a[d].user.nick+")"):($("#nick"+d+" .nick")[0].className="nick vazio",$("#nick"+d+" .nick")[0].innerHTML="<div>"+a[d].user.nick+"</div>",c="url(imgs/spriteTela.png)",$("#nick"+d+" .imagem")[0].style.backgroundPosition="-209px -100px"),c!=$("#nick"+d+" .imagem")[0].style.backgroundImage&&($("#nick"+d+" .imagem")[0].style.backgroundImage=c),a[d].user.confirmacao?($("#nick"+d+" .preparado")[0].innerText=idioma.PREPARADO,$("#nick"+d+" .selecao")[0].className="selecao sel",d==buraco.getPosicao()&&($("#btPreparado")[0].value=idioma.NAO_ESTOU_PREPARADO,$("#btPreparado")[0].fastbutton&&$("#btPreparado")[0].fastbutton.destroy(),$("#btPreparado")[0].fastbutton=new FastButton($("#btPreparado")[0],function(){lobbyPreparado(!1)}))):($("#nick"+d+" .preparado")[0].innerText="",$("#nick"+d+" .selecao")[0].className="selecao")):($("#nick"+d)[0].style.opacity="0.6",$("#nick"+d+" .imagem")[0].style.backgroundImage="none",$("#nick"+d+" .nick")[0].className="nick vazio",$("#nick"+d+" .nick")[0].innerHTML=idioma.VAZIO,$("#nick"+d+" .preparado")[0].innerText="",$("#nick"+d+" .selecao")[0].className="selecao");var e=$("#telaLobby .tempo div")[0];buraco.numJogadores()<4?(e.style.webkitTransitionDuration="",e.style.webkitTransitionProperty="",e.style.width="0%"):(b||0===b||(b=1),e.style.width=Math.round(100*b)+"%",setTimeout(function(a){e.style.webkitTransitionDuration=Math.round(3e4*a)+"ms",e.style.webkitTransitionProperty="width",e.style.width="0%"},10,b)),0===buraco.getPosicao()&&($("#btForcarInicio")[0].style.display=buraco.numJogadores()>=2?"inline":"none")}}function sairJogo(){con.envioMsgJogo(19,{})}function logar(){return-1==$("#logNick")[0].value.toLowerCase().search(/^[a-z0-9_]{3,18}$/)?(alerta(idioma.NICK_INVALIDO,idioma.NICK_INVALIDO_TXT),void 0):$("#logSenha")[0].value.length?(aviso(idioma.LOGANDO),document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),con.logar($("#logNick")[0].value,$("#logSenha")[0].value),$("#logSenha")[0].value="",void 0):(alerta(idioma.SENHA_INVALIDA,idioma.SENHA_INVALIDA_TXT1),void 0)}function logarRetorno(a,b){a.login?("telaLogin"==telaAtual&&mudarTela("telaHome",0),$("#nick")[0].value=a.login,$("#nick")[0].disabled=!0,$("#opJogar")[0].innerText=idioma.JOGAR,$("#opLogar")[0].style.display="none",$("#opDeslogar")[0].style.display="block",usuario=a,avatarNum=usuario.avatar,imgAvatar=new Image,imgAvatar.src=avatarNum?"imgs/avatar/"+avatarNum+".jpg":"http://gartic.com.br/avatar.php?nick="+a.login,imgAvatarTemp.src=imgAvatar.src,a.codigo&&(window.localStorage.setItem("nick",a.login),window.localStorage.setItem("codigo",a.codigo)),fecharAlerta()):b||(window.localStorage.getItem("codigo")&&window.localStorage.removeItem("codigo"),alerta(idioma.ERRO,idioma.DADOS_INVALIDOS))}function deslogar(){con.deslogar(),aviso(idioma.DESLOGANDO)}function deslogarRetorno(){var a="Anonimo"+Math.round(1e4*Math.random());window.localStorage.setItem("nick",a),usuario=!1,avatarNum=0,mudarTela("telaHome",0),$("#nick")[0].value=a,$("#nick")[0].disabled=!1,$("#opJogar")[0].innerText=idioma.JOGAR_SEM_LOGIN,$("#opLogar")[0].style.display="block",$("#opDeslogar")[0].style.display="none",window.localStorage.setItem("nick",a),window.localStorage.getItem("codigo")&&window.localStorage.removeItem("codigo"),fecharAlerta()}function validarCadastro(){return document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),-1==$("#cadEmail")[0].value.search(/^[\w\.-]+@\w+\.\w+(\.\w+)?$/)?(alerta(idioma.EMAIL_INVALIDO,idioma.EMAIL_INVALIDO_TXT),!1):-1==$("#cadNick")[0].value.toLowerCase().search(/^[a-z0-9_]{3,18}$/)?(alerta(idioma.NICK_INVALIDO,idioma.NICK_INVALIDO_TXT),!1):$("#cadSenha")[0].value.length<3?(alerta(idioma.SENHA_INVALIDA,idioma.SENHA_INVALIDA_TXT2),!1):$("#cadSenha")[0].value!=$("#cadSenhaConf")[0].value?(alerta(idioma.SENHA_INVALIDA,idioma.SENHA_INVALIDA_TXT3),!1):!0}function cadastrar(){validarCadastro()&&(carregandoElem.style.display="block",con.cadastrar($("#cadNick")[0].value,$("#cadEmail")[0].value,$("#cadSenha")[0].value,avatarNum))}function cadastrarRetorno(a){a.erro?alerta(idioma.ERRO,idioma.LOGIN_EMAIL_EXISTE):(alerta(idioma.CADASTRO,idioma.CADASTRO_TXT),mudarTela("telaHome",0)),fecharCarregando()}function aviso(a){buraco&&buraco.fecharOpcoes(),$("#alerta .titulo")[0].innerText=a,$("#alerta .mensagem")[0].innerText=idioma.AGUARDE,$("#alertaOK")[0].style.display="none",$("#alertaCancelar")[0].style.display="none",$("#alerta")[0].className="avisar",$("#alerta")[0].style.display="block",carregandoElem.style.backgroundColor="rgba(0,0,0,0.5)",carregandoElem.style.display="block"}function alerta(a,b,c){$("#alerta .titulo")[0].innerText=a,$("#alerta .mensagem")[0].innerText=b,$("#alertaOK")[0].fastbutton&&$("#alertaOK")[0].fastbutton.destroy(),$("#alertaOK")[0].fastbutton=new FastButton($("#alertaOK")[0],c instanceof Function?c:fecharAlerta),$("#alertaOK")[0].style.display="inline",$("#alertaCancelar")[0].style.display="none",$("#alerta")[0].className="alertar",$("#alerta")[0].style.display="block",carregandoElem.style.backgroundColor="rgba(0,0,0,0.5)",carregandoElem.style.display="block"}function confirma(a,b,c){$("#alerta .titulo")[0].innerText=a,$("#alerta .mensagem")[0].innerText=b,$("#alertaOK")[0].style.display="inline",$("#alertaCancelar")[0].style.display="inline",$("#alerta")[0].className="confirmar",$("#alerta")[0].style.display="block",carregandoElem.style.backgroundColor="rgba(0,0,0,0.5)",carregandoElem.style.display="block",$("#alertaOK")[0].fastbutton&&$("#alertaOK")[0].fastbutton.destroy(),$("#alertaOK")[0].fastbutton=new FastButton($("#alertaOK")[0],c instanceof Function?c:fecharAlerta),document.activeElement&&document.activeElement.blur&&document.activeElement.blur()}function fecharAlerta(){$("#alerta")[0].style.display="none",carregandoElem.style.display="none",carregandoElem.style.backgroundColor="rgba(255,255,255,0.5)"}function fecharCarregando(){"block"!=$("#alerta")[0].style.display&&"block"!=$("#opcoesTela")[0].style.display&&(carregandoElem.style.display="none")}function forcarInicio(){confirma(idioma.AVISO,idioma.INICIAR_BOTS,function(){fecharAlerta(),carregandoElem.style.display="block",con.forcarInicio()})}function selRank(a){for(var b=$("#listaRanking>a"),c=0;c<b.length;c++)b[c].className="";$("#btRank"+a)[0].className="sel",carregandoElem.style.display="block",con.obterRank(a,0)}function selSobre(a){for(var b=$("#topSobre>a"),c=0;c<b.length;c++)b[c].className="";$("#btSobre"+a)[0].className="sel",a?($("#sobreAba1")[0].style.display="block",$("#sobreAba0")[0].style.display="none"):($("#sobreAba0")[0].style.display="block",$("#sobreAba1")[0].style.display="none")}function mostrarRank(a){fecharCarregando();var b,c,d,e,f,g,h=$("#telaRanking .lista")[0];a.inicio||(h.innerHTML="",myScroll.scrollTo(0,0));for(var i=0;i<a.rank.length;i++)b=document.createElement("div"),b.className=0==i%2?"linhaPar":"linhaImpar",2>=i&&!a.inicio?(b.className+=" primeiro",g=document.createElement("div"),g.className="icone",f=document.createElement("div"),f.className="foto",f.style.backgroundImage=a.rank[i].avatar?"url(imgs/avatar/"+a.rank[i].avatar+"_min.jpg)":"url(http://www.gartic.com.br/avatar.php?tipo=min&nick="+a.rank[i].nick+")",b.appendChild(g),b.appendChild(f)):(c=document.createElement("div"),c.className="posicao",c.innerText=a.inicio+i+1,b.appendChild(c)),b.loginUser=a.rank[i].nick,b.addEventListener("click",function(){carregandoElem.style.display="block",con.obterDadosUser(this.loginUser)},!1),d=document.createElement("div"),d.className="nick",d.innerText=a.rank[i].nick,e=document.createElement("div"),e.className="pontos",e.innerText=a.rank[i].pontuacao,b.appendChild(d),b.appendChild(e),h.appendChild(b);$("#rankUser .posicao")[0].innerText=a.posicao,$("#rankUser .nick")[0].innerText=window.localStorage.getItem("nick"),$("#rankUser .foto")[0].style.backgroundImage=!avatarNum&&usuario?"url(http://gartic.com.br/avatar.php?nick="+usuario.login+"&tipo=min)":"url(imgs/avatar/"+avatarNum+"_min.jpg)",$("#rankUser .pontos")[0].innerText=a.pontuacao,a.inicio<80?($("#rankVerMaisClick")[0].onclick=function(){carregandoElem.style.display="block",con.obterRank(a.tipo,a.inicio+20),this.disabled=!0},$("#rankVerMais input")[0].disabled=!1,$("#rankVerMais")[0].style.display=a.rank.length>=20?"block":"none"):$("#rankVerMais")[0].style.display="none",myScroll.refresh()}function editarAvatar(){""==$("#areaAvatar")[0].className?($("#areaAvatar")[0].className="sel",$("#telaDeslogar .editarAvatar")[0].innerHTML=idioma.SELECIONAR,imgAvatarTemp.src=imgAvatar.src):($("#areaAvatar")[0].className="",$("#telaDeslogar .editarAvatar")[0].innerHTML=idioma.EDITAR_AVATAR,con.editarAvatar(avatarNum),imgAvatar.src=imgAvatarTemp.src,avatarRand++)}function avatar(a){avatarNum+=a,0>avatarNum?avatarNum=30:avatarNum>30&&(avatarNum=0),imgAvatarTemp.src=0!=avatarNum?"imgs/avatar/"+avatarNum+".jpg":"http://gartic.com.br/avatar.php?nick="+usuario.login,$("#avatarGrande")[0].style.backgroundImage="url("+imgAvatarTemp.src+")"}function avatarCadastro(a){avatarNum+=a,0>avatarNum?avatarNum=30:avatarNum>30&&(avatarNum=0),imgAvatarTemp.src="imgs/avatar/"+avatarNum+".jpg",$("#cadAvatar")[0].style.backgroundImage="url("+imgAvatarTemp.src+")"}function esqueceuSenha(){return document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),-1==$("#senEmail")[0].value.search(/^[\w\.-]+@\w+\.\w+(\.\w+)?$/)?(alerta(idioma.EMAIL_INVALIDO,idioma.EMAIL_INVALIDO_TXT),!1):-1==$("#senNick")[0].value.toLowerCase().search(/^[a-z0-9_]{3,18}$/)?(alerta(idioma.NICK_INVALIDO,idioma.NICK_INVALIDO_TXT),!1):$("#senSenha")[0].value.length<3?(alerta(idioma.SENHA_INVALIDA,idioma.SENHA_INVALIDA_TXT2),!1):$("#senSenha")[0].value!=$("#senSenhaConf")[0].value?(alerta(idioma.SENHA_INVALIDA,idioma.SENHA_INVALIDA_TXT3),!1):(carregandoElem.style.display="block",con.esqueceuSenha($("#senNick")[0].value,$("#senEmail")[0].value,$("#senSenha")[0].value),void 0)}function esqueceuSenhaRetorno(a){fecharCarregando(),a.retorno?(mudarTela("telaHome",0),alerta(idioma.AVISO,idioma.RECUPERAR_CONF)):alerta(idioma.ERRO,idioma.ERRO_RECUPERAR)}var ajax=new Ajax,timerRefresh=!1,imgAvatar,imgAvatarTemp=new Image,avatarRand=Math.ceil(1e3*Math.random()),imagens=[],usuario=!1,usuarioAlvo=!1,buraco=!1,tamanhoVertical=0,tamanhoHorizontal=0,travarBotao=!1,abrindo=!1,loader,myScroll,carregandoElem=$("#loadBg")[0],rolagemElem=$("#telaRolagem")[0];document.addEventListener("touchmove",blockScroll,!1),aviso(idioma.CONECTANDO),document.addEventListener("deviceready",function(){document.addEventListener("backbutton",onBackButton,!1),loader=new Loader(function(){new FastButton($("#opJogar")[0],function(){mudarTela("telaJogar",1)}),new FastButton($("#opLogar")[0],function(){mudarTela("telaLogin",1)}),new FastButton($("#opDeslogar")[0],function(){mudarTela("telaDeslogar",1)}),new FastButton($("#opRanking")[0],function(){mudarTela("telaRanking",1)}),new FastButton($("#opIcone")[0],function(){mudarTela("telaSobre",1)}),new FastButton($("#popFechar")[0],function(){buraco.fecharOpcoes()}),new FastButton($("#alertaCancelar")[0],function(){fecharAlerta()}),new FastButton($("#btForcarInicio")[0],function(){forcarInicio(!0)}),$("#btPreparado")[0].fastbutton=new FastButton($("#btPreparado")[0],function(){lobbyPreparado(!0)}),window.localStorage.getItem("nick")||window.localStorage.setItem("nick",idioma.ANONIMO+Math.round(1e4*Math.random())),iniciarConexao(),$("#nick")[0].addEventListener("blur",function(){-1==this.value.toLowerCase().search(/^[a-z0-9_]{3,18}$/)?(this.value=window.localStorage.getItem("nick"),alerta(idioma.NICK_INVALIDO,idioma.NICK_INVALIDO_TXT)):window.localStorage.setItem("nick",this.value)},!1),$("#logo")[0].addEventListener("touchstart",function(){var a=this;a.className="",setTimeout(function(){a.className="animacao"},0)})})},!1);var timerInicio=!1,telaAtual="telaHome",telaAnterior="",avatarNum=0;